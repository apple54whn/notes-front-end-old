---
title: æºç 
date: 2022-01-13 19:16:38
permalink: /pages/2e2905/
categories:
  - x
  - åŸºç¡€
tags:
  - 
---

# æºç 

## æºç  clone ğŸ”¥

æ­¥éª¤ï¼š

1.   `git clone git@github.com:vuejs/vue-next.git`

2.   `git checkout -b conangan-v3.2.9 v3.2.9`åˆ‡æ¢å¹¶åˆ›å»ºåˆ†æ”¯ã€‚å¯ä»¥ä½¿ç”¨`git tag`æŸ¥çœ‹ tag

3.   `yarn`å®‰è£…ä¾èµ–

4.   åœ¨ package.json ä¸­çš„ dev é€‰é¡¹åé¢åŠ ä¸Š `--sourcemap`ï¼Œå°±å¯ä»¥åœ¨debugæ—¶çœ‹åˆ°ç‹¬ç«‹çš„æ–‡ä»¶è€Œä¸æ˜¯æ‰“åŒ…åçš„æ–‡ä»¶

5.   æ‰§è¡Œ`yarn dev`å‘½ä»¤ï¼Œä¼šè‡ªåŠ¨æ‰“åŒ…æ–‡ä»¶ï¼Œå¹¶ä¼šç”Ÿæˆ`packages/vue/dist/vue.global.js`å’Œ`*.map`æ–‡ä»¶

6.   åˆ›å»º`packages/vue/examples/conanan`è¿™ä¸ªç›®å½•ï¼Œç”¨äºè‡ªå·±å†™demo

     ```html
     <!DOCTYPE html>
     <html lang="en">
       <head>
         <meta charset="UTF-8" />
         <meta http-equiv="X-UA-Compatible" content="IE=edge" />
         <meta name="viewport" content="width=device-width, initial-scale=1.0" />
         <title>Document</title>
       </head>
       <body>
         <div id="app"></div>
     
         <template id="temp">
           <button @click="decrement">-</button>
           <span>{{counter}}</span>
           <button @click="increment">+</button>
         </template>
     
         <script src="../../dist/vue.global.js"></script>
     
         <script>
           const options = {
             template: '#temp', //
             data() {
               return {
                 counter: 0
               }
             },
             methods: {
               decrement() {
                 this.counter--
               },
               increment() {
                 this.counter++
               }
             }
           }
           // debugger
           const vm = Vue.createApp(options).mount('#app')
         </script>
       </body>
     </html>
     ```

     debugä¼šå‘ç°`createApp`è¿›å…¥çš„æ˜¯`index.ts`æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä¸Šé¢ç”Ÿæˆçš„`vue.global.js`





## æºç ä¹‹ createApp

![image-20220208001404724](./images/image-20220208001404724.png)





## æºç é˜…è¯»ä¹‹æŒ‚è½½æ ¹ç»„ä»¶

![image-20220208001432707](./images/image-20220208001432707.png)



## ç»„ä»¶åŒ–çš„åˆå§‹åŒ–

![image-20220208001506431](./images/image-20220208001506431.png)





## templateä¸­æ•°æ®çš„ä½¿ç”¨é¡ºåº

```js
// data / props / ctx
// This getter gets called for every property access on the render context
// during render and is a major hotspot. The most expensive part of this
// is the multiple hasOwn() calls. It's much faster to do a simple property
// access on a plain object, so we use an accessCache object (with null
// prototype) to memoize what access type a key corresponds to.
let normalizedProps
if (key[0] !== '$') {
    const n = accessCache![key]
    if (n !== undefined) {
        switch (n) {
            case AccessTypes.SETUP:
                return setupState[key]
            case AccessTypes.DATA:
                return data[key]
            case AccessTypes.CONTEXT:
                return ctx[key]
            case AccessTypes.PROPS:
                return props![key]
                // default: just fallthrough
        }
    } else if (setupState !== EMPTY_OBJ && hasOwn(setupState, key)) {
        accessCache![key] = AccessTypes.SETUP
        return setupState[key]
    } else if (data !== EMPTY_OBJ && hasOwn(data, key)) {
        accessCache![key] = AccessTypes.DATA
        return data[key]
    } else if (
        // only cache other properties when instance has declared (thus stable)
        // props
        (normalizedProps = instance.propsOptions[0]) &&
        hasOwn(normalizedProps, key)
    ) {
        accessCache![key] = AccessTypes.PROPS
        return props![key]
    } else if (ctx !== EMPTY_OBJ && hasOwn(ctx, key)) {
        accessCache![key] = AccessTypes.CONTEXT
        return ctx[key]
    } else if (!__FEATURE_OPTIONS_API__ || shouldCacheAccess) {
        accessCache![key] = AccessTypes.OTHER
    }
}
```

ç”±æºç å¯çŸ¥ï¼šsetupâ€”â€”dataâ€”â€”propsâ€”â€”ctxï¼ˆmethodsã€computedï¼‰
